server:
  # socket_path: defaults to $XDG_RUNTIME_DIR/pantalk.sock (or /tmp/pantalk-<uid>.sock)
  # db_path: defaults to ~/.local/share/pantalk/pantalk.db
  notification_history_size: 1000

# ---

bots:
  - name: ops-bot
    type: slack
    bot_token: $SLACK_BOT_TOKEN_OPS
    app_level_token: $SLACK_APP_LEVEL_TOKEN_OPS
    channels:
      - '#ops' # friendly name (resolved to channel ID at startup)

  - name: eng-bot
    type: slack
    bot_token: $SLACK_BOT_TOKEN_ENG
    app_level_token: $SLACK_APP_LEVEL_TOKEN_ENG
    channels:
      - '#engineering' # friendly name â€“ also accepts raw IDs like C0123456789

  - name: discord-bot
    type: discord
    bot_token: $DISCORD_BOT_TOKEN_OPS
    channels:
      - '#general' # friendly name (resolved to channel ID at startup)

  - name: support-bot
    type: mattermost
    bot_token: $MATTERMOST_BOT_TOKEN_SUPPORT
    endpoint: https://mattermost.example.com
    channels:
      - town-square # friendly name (resolved to channel ID at startup)

  - name: alerts-bot
    type: telegram
    bot_token: $TELEGRAM_BOT_TOKEN_ALERTS
    channels:
      - '@my_alerts_channel' # public channel username (resolved to chat ID at startup)

  - name: my-whatsapp
    type: whatsapp
    # db_path: defaults to ~/.local/share/pantalk/whatsapp-my-whatsapp.db
    # channels:               # optional: limit to specific chats
    #   - '1234567890@s.whatsapp.net'
    #   - '12345678-9876543@g.us'

  - name: irc-bot
    type: irc
    endpoint: irc.libera.chat:6697
    # password: $IRC_SERVER_PASSWORD      # optional: server password
    channels:
      - '#mychannel'

  - name: matrix-bot
    type: matrix
    access_token: $MATRIX_ACCESS_TOKEN
    endpoint: https://matrix.example.com
    channels:
      - '#general:matrix.org' # room alias (resolved to room ID at startup)

  - name: sms-bot
    type: twilio
    auth_token: $TWILIO_AUTH_TOKEN
    account_sid: $TWILIO_ACCOUNT_SID
    phone_number: '+15551234567'
    channels:
      - '+15559876543'

  - name: zulip-bot
    type: zulip
    api_key: $ZULIP_API_KEY
    bot_email: $ZULIP_BOT_EMAIL
    endpoint: https://your-org.zulipchat.com
    channels:
      - general # stream name (resolved to stream ID at startup)

# ---

# Agents are preconfigured commands that launch automatically when matching
# events arrive. By default only known agent binaries (claude, codex, aider,
# goose) are permitted. Start pantalkd with --allow-exec to allow arbitrary
# commands. The "when" field uses an expression language with boolean operators
# (&&, ||, !) and event fields: notify, direct, mentions, channel, thread,
# bot, service, user, text. Time-based triggers are also supported via at()
# and every() functions. Default when is "notify".
#
# agents:
#   - name: responder                     # identifier for logging
#     when: "direct || mentions"           # expression (default: "notify")
#     command: claude -p "Check pantalk notifications and respond"
#     workdir: /home/user/project          # optional working directory
#     buffer: 30                           # seconds to batch before launching
#     timeout: 120                         # kill after N seconds
#     cooldown: 60                         # min gap between runs
#
#   - name: incident-watcher
#     when: "notify && channel == '#incidents'"
#     command: claude -p "Triage the incident"
#     workdir: /home/user/ops
#     buffer: 10
#     timeout: 300
#     cooldown: 120
#
#   - name: morning-digest
#     when: 'at("9:00") && weekday in ["mon","tue","wed","thu","fri"]'
#     command: claude -p "Summarize overnight notifications"
#     workdir: /home/user/project
#     timeout: 300
#
#   - name: periodic-check
#     when: 'every("30m") || direct'
#     command: claude -p "Check notifications and respond"
#     workdir: /home/user/project
